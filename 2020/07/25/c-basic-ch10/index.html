<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  

  
  <title>C Basic ch10(數組和指針) | Bot-99&#39;s blog</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="數組123float candy[365]; &#x2F;&#x2F;創建有365個float類型的數組char code[12]; &#x2F;&#x2F;創建有12個char類型的數組int states[50]; &#x2F;&#x2F;創建有50個int類型的數組  倘若我們想設定數組為只讀,那麼可以使用const 1const int days[MONTHS] &#x3D; &amp;#123;31,28,31,30,31,30,31,31,30,31,30,31">
<meta property="og:type" content="article">
<meta property="og:title" content="C Basic ch10(數組和指針)">
<meta property="og:url" content="http://yoursite.com/2020/07/25/c-basic-ch10/index.html">
<meta property="og:site_name" content="Bot-99&#39;s blog">
<meta property="og:description" content="數組123float candy[365]; &#x2F;&#x2F;創建有365個float類型的數組char code[12]; &#x2F;&#x2F;創建有12個char類型的數組int states[50]; &#x2F;&#x2F;創建有50個int類型的數組  倘若我們想設定數組為只讀,那麼可以使用const 1const int days[MONTHS] &#x3D; &amp;#123;31,28,31,30,31,30,31,31,30,31,30,31">
<meta property="og:locale" content="en_US">
<meta property="article:published_time" content="2020-07-25T06:41:33.000Z">
<meta property="article:modified_time" content="2020-08-03T10:55:45.000Z">
<meta property="article:author" content="John Doe">
<meta property="article:tag" content="C">
<meta name="twitter:card" content="summary">
  
  
    <link rel="icon" href="/favicon.png">
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  
<link rel="stylesheet" href="/css/style.css">

<meta name="generator" content="Hexo 4.2.1"></head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">Bot-99&#39;s blog</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
          <a class="main-nav-link" href="/about">About</a>
        
      </nav>
      <nav id="sub-nav">
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://yoursite.com"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main"><article id="post-c-basic-ch10" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2020/07/25/c-basic-ch10/" class="article-date">
  <time datetime="2020-07-25T06:41:33.000Z" itemprop="datePublished">2020-07-25</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      C Basic ch10(數組和指針)
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="數組"><a href="#數組" class="headerlink" title="數組"></a>數組</h2><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">float</span> candy[<span class="number">365</span>]; <span class="comment">//創建有365個float類型的數組</span></span><br><span class="line"><span class="keyword">char</span> code[<span class="number">12</span>]; <span class="comment">//創建有12個char類型的數組</span></span><br><span class="line"><span class="keyword">int</span> states[<span class="number">50</span>]; <span class="comment">//創建有50個int類型的數組</span></span><br></pre></td></tr></table></figure>

<p>倘若我們想設定數組為只讀,那麼可以使用<code>const</code></p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> days[MONTHS] = &#123;<span class="number">31</span>,<span class="number">28</span>,<span class="number">31</span>,<span class="number">30</span>,<span class="number">31</span>,<span class="number">30</span>,<span class="number">31</span>,<span class="number">31</span>,<span class="number">30</span>,<span class="number">31</span>,<span class="number">30</span>,<span class="number">31</span>&#125;;</span><br></pre></td></tr></table></figure>

<p>* <strong>目前所有val和array仍處於自動儲存類別</strong></p>
<p>在C99下有一個新的特性</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> arr[<span class="number">6</span>] = &#123;[<span class="number">5</span>] = <span class="number">100</span>&#125;; <span class="comment">// 把arr[5]設定為100</span></span><br><span class="line">----------------------------------------------</span><br><span class="line"><span class="keyword">int</span> arr[<span class="number">6</span>] = &#123;<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">100</span>&#125;; <span class="comment">//這是傳統方法</span></span><br></pre></td></tr></table></figure>

<p>以新的方法初始數組，除了特定有賦值的元素，其餘皆為0</p>
<h4 id="錯誤示範"><a href="#錯誤示範" class="headerlink" title="錯誤示範"></a>錯誤示範</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">define</span> SIZE 5;</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> oxen[SIZE] = &#123;<span class="number">5</span>,<span class="number">3</span>,<span class="number">2</span>,<span class="number">8</span>&#125;;</span><br><span class="line">	<span class="keyword">int</span> yaks[SIZE];</span><br><span class="line"></span><br><span class="line">	yaks = oxen; <span class="comment">//不允許</span></span><br><span class="line">	yaks[SIZE] = oxen[SIZE]; <span class="comment">//越界，yaks和oxen最後的元素應是yaks[4]和oxen[4]</span></span><br><span class="line">	yaks[SIZE] = &#123;<span class="number">5</span>,<span class="number">3</span>,<span class="number">2</span>,<span class="number">8</span>&#125;; <span class="comment">//沒有作用</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>使用數組時，我們需注意數組邊界，數組的第一個元素是在0的，故此數組最後一個元素因是數組的大小減1。</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> arr[<span class="number">5</span>]; <span class="comment">//arr[x] x的範圍是在0~4</span></span><br></pre></td></tr></table></figure>

<p>另外，定義數組亦有以下規則</p>
<ul>
<li>數組大小必須大於0</li>
<li>數組大小必須為整數</li>
</ul>
<h2 id="多維數組"><a href="#多維數組" class="headerlink" title="多維數組"></a>多維數組</h2><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">float</span> rain[<span class="number">5</span>][<span class="number">12</span>]; <span class="comment">//內有5個數組元素的數組，而每個數組內有12個float類型元素</span></span><br></pre></td></tr></table></figure>

<h4 id="創建二位數組"><a href="#創建二位數組" class="headerlink" title="創建二位數組"></a>創建二位數組</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> mark[subjects][papers] = &#123;</span><br><span class="line">  																		&#123;<span class="number">19</span>, <span class="number">11</span>, <span class="number">11</span>&#125;,   <span class="comment">//第一列</span></span><br><span class="line"> 																			&#123;<span class="number">19</span>, <span class="number">7</span>,  <span class="number">21</span>&#125;    <span class="comment">//第二列</span></span><br><span class="line">																		&#125;</span><br></pre></td></tr></table></figure>

<h2 id="指針和數組"><a href="#指針和數組" class="headerlink" title="指針和數組"></a>指針和數組</h2><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">test == &amp;test[<span class="number">0</span>] <span class="comment">//成立，兩個皆是給數組首元素地址，而且都是const</span></span><br><span class="line">---------</span><br><span class="line"><span class="keyword">int</span> data[x], *ptr;</span><br><span class="line">ptr = data; <span class="comment">// equal to ptr = &amp;data[0]</span></span><br></pre></td></tr></table></figure>

<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> SIZE 4</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    short dates[SIZE] = &#123;<span class="number">2</span>,<span class="number">4</span>,<span class="number">6</span>,<span class="number">8</span>&#125;;</span><br><span class="line">    short *pti;</span><br><span class="line">    short index;</span><br><span class="line">    <span class="keyword">double</span> bills[SIZE] = &#123;<span class="number">2</span>,<span class="number">4</span>,<span class="number">6</span>,<span class="number">8</span>&#125;;</span><br><span class="line">    <span class="keyword">double</span> *ptf;</span><br><span class="line"></span><br><span class="line">    pti = dates;</span><br><span class="line">    ptf = bills;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; SIZE; i++)&#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"pointers + %d: %d %p %f %p \n"</span>, i, *(pti + i), pti + i, *(ptf + i), ptf + i);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//result</span></span><br><span class="line"><span class="comment">//pointers + 0: 2 0x7fff55ce8870 2.000000 0x7fff55ce8850 </span></span><br><span class="line"><span class="comment">//pointers + 1: 4 0x7fff55ce8872 4.000000 0x7fff55ce8858 </span></span><br><span class="line"><span class="comment">//pointers + 2: 6 0x7fff55ce8874 6.000000 0x7fff55ce8860 </span></span><br><span class="line"><span class="comment">//pointers + 3: 8 0x7fff55ce8876 8.000000 0x7fff55ce8868</span></span><br></pre></td></tr></table></figure>

<p>short類型占2字節，故此<code>0x7fff5a9de870 + 1 = 0x7fff5a9de872</code></p>
<p>double類型占8字節，所以<code>0x7fff5a9de850 + 1 = 0x7fff5a9de858</code></p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">dates + <span class="number">2</span> == &amp;dates[<span class="number">2</span>] <span class="comment">//相同的地址</span></span><br><span class="line">*(dates + <span class="number">2</span>) == dates[<span class="number">2</span>] <span class="comment">//相同的值</span></span><br></pre></td></tr></table></figure>

<p><code>*</code> 可以得到指針的值</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">*(dates + <span class="number">2</span>) <span class="comment">// equal to dates[2]</span></span><br><span class="line">*(dates) + <span class="number">2</span> <span class="comment">// equal to dates[0] + 2</span></span><br></pre></td></tr></table></figure>

<h3 id="聲明形式"><a href="#聲明形式" class="headerlink" title="聲明形式"></a>聲明形式</h3><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">sum</span><span class="params">(<span class="keyword">int</span> *ar, <span class="keyword">int</span> n)</span></span>;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">sum</span><span class="params">(<span class="keyword">int</span> *, <span class="keyword">int</span>)</span></span>;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">sum</span><span class="params">(<span class="keyword">int</span> ar[], <span class="keyword">int</span> n)</span></span>;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">sum</span><span class="params">(<span class="keyword">int</span> [], <span class="keyword">int</span>)</span></span>;</span><br></pre></td></tr></table></figure>

<p>以上有些省略了參數名，但在定義函數時必須加上參數名</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">sum</span><span class="params">(<span class="keyword">int</span> *ar, <span class="keyword">int</span> n)</span></span>&#123;</span><br><span class="line">  ...</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">sum</span><span class="params">(<span class="keyword">int</span> ar[], <span class="keyword">int</span> n)</span></span>&#123;</span><br><span class="line">  ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="使用"><a href="#使用" class="headerlink" title="使用"></a>使用</h4> <figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="keyword">int</span> data[<span class="number">2</span>] = &#123;<span class="number">100</span>,<span class="number">200</span>&#125;;</span><br><span class="line"><span class="keyword">int</span> moredata[<span class="number">2</span>] = &#123;<span class="number">300</span>,<span class="number">400</span>&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> *p1, *p2, *p3;</span><br><span class="line">    p1 = p2 = data;</span><br><span class="line">    p3 = moredata;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">" *p1   = %d, *p2   = %d, *p3     = %d \n"</span>, *p1, *p2, *p3);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">" *p1++ = %d, *++p2 = %d, (*p3)++ = %d \n"</span>, *p1++, *++p2, (*p3)++);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">" *p1   = %d, *p2   = %d, *p3     = %d \n"</span>, *p1, *p2, *p3);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//result</span></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> *p1   = 100, *p2   = 100, *p3     = 300 </span></span><br><span class="line"><span class="comment"> *p1++ = 100, *++p2 = 200, (*p3)++ = 300 </span></span><br><span class="line"><span class="comment"> *p1   = 200, *p2   = 200, *p3     = 301 </span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure>

<p> <code>*p1++</code> 是使用p1的val後，指針+1</p>
<p><code>*++p2</code> 是指針+1後，再使用p2的val</p>
<p><code>(*p3)++</code> 則是在p3的val上+1</p>
<h2 id="const"><a href="#const" class="headerlink" title="const"></a>const</h2><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MONTHS 12</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="keyword">const</span> <span class="keyword">int</span> days[MONTHS] = &#123;<span class="number">31</span>,<span class="number">28</span>,<span class="number">31</span>,<span class="number">30</span>,<span class="number">31</span>,<span class="number">30</span>,<span class="number">31</span>,<span class="number">31</span>,<span class="number">30</span>,<span class="number">31</span>,<span class="number">30</span>,<span class="number">31</span>&#125;;</span><br><span class="line">  days[<span class="number">9</span>] = <span class="number">44</span> <span class="comment">//1 error</span></span><br></pre></td></tr></table></figure>
<ol>
<li><code>days[9] = 44</code> 會導致編譯錯誤，因為<code>days</code>被<code>const</code>保護，所以不能改變其val</li>
</ol>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">	<span class="keyword">double</span> rates[<span class="number">5</span>] = &#123;<span class="number">19.721</span>, <span class="number">100.1</span>, <span class="number">125.2</span>, <span class="number">122.2</span>. <span class="number">535.2</span>&#125;;</span><br><span class="line">	<span class="keyword">const</span> <span class="keyword">double</span> *pd = rates;</span><br><span class="line">	*pd = <span class="number">244.2</span>; <span class="comment">//2.1 error</span></span><br><span class="line">pd[<span class="number">2</span>] = <span class="number">22</span>; <span class="comment">//2.1 error</span></span><br><span class="line">rates[<span class="number">0</span>] = <span class="number">99.2</span>; <span class="comment">//2.2</span></span><br><span class="line"> pd++ <span class="comment">//2.3</span></span><br></pre></td></tr></table></figure>
<ol start="2">
<li><ol>
<li><code>*pd = 244.2</code> 和<code>pd[2] = 22</code> 都是錯誤的，<code>pd</code>的聲明為<code>const</code></li>
<li><code>rates</code>未被<code>const</code>保護，仍可改變</li>
<li>雖<code>pd</code>是<code>const</code>,但仍可以<code>pd++</code>使<code>pd</code>指向<code>rates[1]</code></li>
</ol>
</li>
</ol>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">  <span class="comment">//3</span></span><br><span class="line">  <span class="keyword">double</span> rates[<span class="number">5</span>] = &#123;<span class="number">92.24</span>, <span class="number">20.19</span>, <span class="number">255.24</span>, <span class="number">2.15</span>, <span class="number">25.25</span>&#125;;</span><br><span class="line">  <span class="keyword">const</span> <span class="keyword">double</span> locked[<span class="number">3</span>] = &#123;<span class="number">8.31</span>, <span class="number">7.21</span>, <span class="number">6.12</span>&#125;;</span><br><span class="line">  <span class="keyword">const</span> <span class="keyword">double</span> *pc;</span><br><span class="line">  pc = rates;</span><br><span class="line">  pc = locked;</span><br><span class="line">  pc = &amp;rates[<span class="number">2</span>];</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">double</span> rates2[<span class="number">5</span>] = &#123;<span class="number">92.24</span>, <span class="number">20.19</span>, <span class="number">255.24</span>, <span class="number">2.15</span>, <span class="number">25.25</span>&#125;;</span><br><span class="line">  <span class="keyword">const</span> <span class="keyword">double</span> locked2[<span class="number">3</span>] = &#123;<span class="number">8.31</span>, <span class="number">7.21</span>, <span class="number">6.12</span>&#125;;</span><br><span class="line">  <span class="keyword">double</span> *pc2;</span><br><span class="line">  pc2 = rates2; </span><br><span class="line">  pc2 = locked2; <span class="comment">//error</span></span><br><span class="line">  pc2 = &amp;rates2[<span class="number">2</span>]; <span class="comment">//error</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ol start="3">
<li>pointer 和 const的配合需要注意一下規則<ol>
<li>可以把const或非const的數據賦給const的pointer</li>
<li>普通pointer只能接受非const數據</li>
</ol>
</li>
</ol>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">show_array</span><span class="params">(<span class="keyword">const</span> <span class="keyword">double</span> ar[], <span class="keyword">int</span> n)</span></span>&#123;</span><br><span class="line"> ... </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">mult_array</span><span class="params">(<span class="keyword">double</span> ar[], <span class="keyword">int</span> n, <span class="keyword">double</span> mult)</span></span>&#123;</span><br><span class="line">  ...</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">show_array(rates, <span class="number">5</span>);</span><br><span class="line">show_array(locked, <span class="number">3</span>);</span><br><span class="line"></span><br><span class="line">mult_array(rates, <span class="number">5</span>, <span class="number">2.2</span>);</span><br><span class="line">mult_array(locked, <span class="number">3</span>, <span class="number">3.2</span>); <span class="comment">//error</span></span><br></pre></td></tr></table></figure>

<p>不能利用非const的參數修改const數據</p>
<p>所以<code>const</code>通常用於函數參數中，表面不會利用指針更改數據</p>
<h4 id="其他用法"><a href="#其他用法" class="headerlink" title="其他用法"></a>其他用法</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"> <span class="keyword">double</span> rates[<span class="number">5</span>] = &#123;<span class="number">92.24</span>, <span class="number">20.19</span>, <span class="number">255.24</span>, <span class="number">2.15</span>, <span class="number">25.25</span>&#125;;</span><br><span class="line"> <span class="keyword">const</span> <span class="keyword">double</span> *pc = rates;</span><br><span class="line">pc = &amp;rates[<span class="number">2</span>]; <span class="comment">//error</span></span><br><span class="line"> *pc = <span class="number">92.99</span>;  <span class="comment">//ok</span></span><br></pre></td></tr></table></figure>

<p><code>pc = &amp;rates[2]</code>錯誤，因為該指針不能指向別處</p>
<p> <code>*pc = 92.99</code> 在更改rates[0] 的val</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"> <span class="keyword">double</span> rates[<span class="number">5</span>] = &#123;<span class="number">92.24</span>, <span class="number">20.19</span>, <span class="number">255.24</span>, <span class="number">2.15</span>, <span class="number">25.25</span>&#125;;</span><br><span class="line"> <span class="keyword">const</span> <span class="keyword">double</span> * <span class="keyword">const</span> pc = rates;</span><br><span class="line">pc = &amp;rates[<span class="number">2</span>]; <span class="comment">//error</span></span><br><span class="line">*pc = <span class="number">92.99</span>;  <span class="comment">//error</span></span><br></pre></td></tr></table></figure>

<p>我們可以利用兩次<code>const</code>, 那麼該指針不能改變地址和指針上的值</p>
<h2 id="指針和多維數組"><a href="#指針和多維數組" class="headerlink" title="指針和多維數組"></a>指針和多維數組</h2><p>zippol1.c</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> zippo[<span class="number">4</span>][<span class="number">2</span>] = &#123;&#123;<span class="number">1</span>,<span class="number">2</span>&#125;,</span><br><span class="line">                       &#123;<span class="number">3</span>,<span class="number">4</span>&#125;,</span><br><span class="line">                       &#123;<span class="number">5</span>,<span class="number">6</span>&#125;,</span><br><span class="line">                       &#123;<span class="number">7</span>,<span class="number">8</span>&#125;&#125;;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"zippo        = %p, zippo + 1       = %p, zippo[1] = %p\n"</span>, zippo, zippo + <span class="number">1</span>, zippo[<span class="number">1</span>]);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"zippo[0]     = %p, zippo[0] + 1    = %p\n"</span>, zippo[<span class="number">0</span>], zippo[<span class="number">0</span>] + <span class="number">1</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"*zippo       = %p, *zippo + 1      = %p\n"</span>, *zippo, *zippo+<span class="number">1</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"&amp;zippo[0][0] = %p \n"</span>, &amp;zippo[<span class="number">0</span>][<span class="number">0</span>]);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"zippo[2][1]  = %p, *(*(zippo+2)+1) = %p\n"</span>, &amp;zippo[<span class="number">2</span>][<span class="number">1</span>], &amp;*(*(zippo+<span class="number">2</span>)+<span class="number">1</span>));</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"----"</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"zippo[0][0]     = %d\n"</span>,zippo[<span class="number">0</span>][<span class="number">0</span>]);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"*zippo[0]       = %d\n"</span>,*zippo[<span class="number">0</span>]);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"**zippo         = %d\n"</span>,**zippo);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"zippo[2][1]     = %d\n"</span>,zippo[<span class="number">2</span>][<span class="number">1</span>]);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"*(*(zippo+2)+1) = %d\n"</span>,*(*(zippo+<span class="number">2</span>)+<span class="number">1</span>));</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//result</span></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">zippo        = 0x7fff56082850, zippo + 1       = 0x7fff56082858, zippo[1] = 0x7fff56082858</span></span><br><span class="line"><span class="comment">zippo[0]     = 0x7fff56082850, zippo[0] + 1    = 0x7fff56082854</span></span><br><span class="line"><span class="comment">*zippo       = 0x7fff56082850, *zippo + 1      = 0x7fff56082854</span></span><br><span class="line"><span class="comment">&amp;zippo[0][0] = 0x7fff56082850 </span></span><br><span class="line"><span class="comment">zippo[2][1]  = 0x7fff56082864, *(*(zippo+2)+1) = 0x7fff56082864</span></span><br><span class="line"><span class="comment">----</span></span><br><span class="line"><span class="comment">zippo[0][0]     = 1</span></span><br><span class="line"><span class="comment">*zippo[0]       = 1</span></span><br><span class="line"><span class="comment">**zippo         = 1</span></span><br><span class="line"><span class="comment">zippo[2][1]     = 6</span></span><br><span class="line"><span class="comment">*(*(zippo+2)+1) = 6</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure>

<p><code>**</code> 雙向間接 double indirection，使用<code>*</code>或在數組後使用<code>[]</code>皆能得到相應的val。</p>
<p><code>zippo</code>[0] 是<code>zippo[0][0]</code> 的地址，<code>*(zippo[0])</code>表示存在<code>zippo[0][0]</code>的val，所以<code>*zippo</code>等於<code>zippo[0]</code>的val，但<code>zippo[0]</code>本身是一個int類型的地址，即<code>&amp;zippo[0][0]</code>的地址。</p>
<p><code>*zippo</code> 等於 <code>&amp;zippo[0][0]</code></p>
<p>所以， <code>**zippo</code> 等於<code>*&amp;zippo[0][0]</code></p>
<p>zippol2.c</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> zippo[<span class="number">4</span>][<span class="number">2</span>] = &#123;&#123;<span class="number">1</span>,<span class="number">2</span>&#125;,</span><br><span class="line">                        &#123;<span class="number">3</span>,<span class="number">4</span>&#125;,</span><br><span class="line">                        &#123;<span class="number">5</span>,<span class="number">6</span>&#125;,</span><br><span class="line">                        &#123;<span class="number">7</span>,<span class="number">8</span>&#125;&#125;;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">int</span> (*pz)[<span class="number">2</span>];</span><br><span class="line">    pz = zippo;</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"    pz = %p, pz + 1    = %p, pz[1] = %p\n"</span>, pz, pz+<span class="number">1</span>, pz[<span class="number">1</span>]);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">" pz[0] = %p, pz[0] + 1 = %p\n"</span>, pz[<span class="number">0</span>], pz[<span class="number">0</span>]+<span class="number">1</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">" *pz   = %p, *pz + 1   = %p\n"</span>, *pz, *pz+<span class="number">1</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"pz[0][0] = %d\n"</span>, pz[<span class="number">0</span>][<span class="number">0</span>]);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"*pz[0]   = %d\n"</span>, *pz[<span class="number">0</span>]);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"**pz[0]  = %d\n"</span>, **pz);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"pz[2][1] = %d\n"</span>, pz[<span class="number">2</span>][<span class="number">1</span>]);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"*(*(pz+2)+1) = %d\n"</span>, *(*(pz+<span class="number">2</span>)+<span class="number">1</span>));</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//result</span></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">    pz = 0x7fff5bc88850, pz + 1    = 0x7fff5bc88858, pz[1] = 0x7fff5bc88858</span></span><br><span class="line"><span class="comment"> pz[0] = 0x7fff5bc88850, pz[0] + 1 = 0x7fff5bc88854</span></span><br><span class="line"><span class="comment"> *pz   = 0x7fff5bc88850, *pz + 1   = 0x7fff5bc88854</span></span><br><span class="line"><span class="comment">pz[0][0] = 1</span></span><br><span class="line"><span class="comment">*pz[0]   = 1</span></span><br><span class="line"><span class="comment">**pz[0]  = 1</span></span><br><span class="line"><span class="comment">pz[2][1] = 6</span></span><br><span class="line"><span class="comment">*(*(pz+2)+1) = 6</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure>

<ul>
<li><code>int (*pz)[2]</code> 不等於<code>int * pz[2]</code> ，因為<code>[]</code> 優於<code>*</code></li>
</ul>
<p>​      <code>int (*pz)[2]</code> 是指pz指向一個內有兩個int類型的數組</p>
<p>​      <code>int * pz[2]</code>是指pz是一個內有兩個int類型的數組，每個元素都指向int的ptr</p>
<ul>
<li>雖pz是一個ptr，但仍能如數組一樣，以<code>pz[2][1]</code>這種寫法表達<ul>
<li><code>zippo[m][n] == *(*(zippo + m ) + n)</code></li>
<li><code>pz[m][n] == *(*(pz + m) + n)</code></li>
</ul>
</li>
</ul>
<h3 id="指針的兼容性"><a href="#指針的兼容性" class="headerlink" title="指針的兼容性"></a>指針的兼容性</h3><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> n = <span class="number">5</span>;</span><br><span class="line"><span class="keyword">double</span> x;</span><br><span class="line"><span class="keyword">int</span> *p1 = &amp;n;</span><br><span class="line"><span class="keyword">double</span> *pd = &amp;x;</span><br><span class="line">x = n;   <span class="comment">//隱式轉換</span></span><br><span class="line">pd = p1; <span class="comment">//編譯會錯誤</span></span><br></pre></td></tr></table></figure>

<p>我們可以直接轉換類型，即如<code>x=n</code>把int類型的值賦於double類型，但兩個不同類型的指針不能如此</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> * pt;</span><br><span class="line"><span class="keyword">int</span> (*pa)[<span class="number">3</span>];</span><br><span class="line"><span class="keyword">int</span> ar1[<span class="number">2</span>][<span class="number">3</span>];</span><br><span class="line"><span class="keyword">int</span> ar2[<span class="number">3</span>][<span class="number">2</span>];</span><br><span class="line"><span class="keyword">int</span> **p2; <span class="comment">//指向ptr的ptr</span></span><br><span class="line"></span><br><span class="line">pt = &amp;ar1[<span class="number">0</span>][<span class="number">0</span>]; <span class="comment">//都是指向int的ptr</span></span><br><span class="line">pt = ar1[<span class="number">0</span>];  <span class="comment">//都是指向int的ptr   &amp;ar1[0][0] == ar1[0]</span></span><br><span class="line">pt = ar1; <span class="comment">//無效，ar2是指向內有3個int類型元素的指針</span></span><br><span class="line"></span><br><span class="line">pa = ar1; <span class="comment">//都是指向內有3個int類型元素的指針</span></span><br><span class="line">pa = ar2; <span class="comment">//無效，ar2是指向內有2個int類型元素的指針</span></span><br><span class="line">p2 = &amp;pt; <span class="comment">//both pointer to int *</span></span><br><span class="line">*p2 = ar2[<span class="number">0</span>]; <span class="comment">//都是指向int的指針</span></span><br><span class="line">p2 = ar2; <span class="comment">//無效，ar2是指向內有3個int類型元素的指針</span></span><br></pre></td></tr></table></figure>

<p><code>*p2</code>是指向int的指針，而<code>ar2[0]</code>是指向<code>ar[0][0]</code>的指針，所以同類型</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> x = <span class="number">20</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> y = <span class="number">23</span>;</span><br><span class="line"><span class="keyword">int</span> *p1 = &amp;x;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> *p2 = &amp;y;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> **pp2;</span><br><span class="line"></span><br><span class="line">p1 = p2; <span class="comment">//unsafe 把const指針賦給非const</span></span><br><span class="line">p2 = p1; <span class="comment">//safe 把非const指針賦給const</span></span><br><span class="line">pp2 = &amp;p1; <span class="comment">//unsafe</span></span><br></pre></td></tr></table></figure>

<p>當2級解引用時，賦值也不安全(以下的變化，還不是很懂！！！！！)</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> **pp2;</span><br><span class="line"><span class="keyword">int</span> *p1;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> n = <span class="number">13</span>;</span><br><span class="line">pp2 = &amp;p1; <span class="comment">//permit 但致const失效</span></span><br><span class="line">*pp2 = &amp;n; <span class="comment">//ok, 兩者都為const，導致p1指向n （為什麼p1會指向n？）</span></span><br><span class="line">*p1 = <span class="number">10</span>; <span class="comment">//ok,但改變n的val</span></span><br></pre></td></tr></table></figure>

<h2 id="func-amp-multi-dim-array"><a href="#func-amp-multi-dim-array" class="headerlink" title="func &amp; multi dim array"></a>func &amp; multi dim array</h2><p>聲明</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">somefunc</span><span class="params">( <span class="keyword">int</span> (*pt)[<span class="number">4</span>] )</span></span>;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">somefunc</span><span class="params">( <span class="keyword">int</span> pt[][<span class="number">4</span>])</span></span>;</span><br></pre></td></tr></table></figure>

<p>第一個<code>[]</code>是空的，即表明pt是一個ptr</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">somefunc</span><span class="params">( <span class="keyword">int</span> pt[][], <span class="keyword">int</span> rows)</span></span>; <span class="comment">//error</span></span><br></pre></td></tr></table></figure>

<p>編譯器會把所有數組表示法轉成指針表示法。例如，把<code>pt[1]</code>轉為<code>pt + 1</code></p>
<p>編譯器對pt+1求值，所以要求知道pt的大小</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">somefunc</span><span class="params">( <span class="keyword">int</span> pt[][<span class="number">4</span>], <span class="keyword">int</span> rows)</span></span>; <span class="comment">//ok</span></span><br></pre></td></tr></table></figure>

<p>pt指向一個內有4個int類型的數組，一個int等於4bytes，所以pt指向的對象占16bytes。因此每當pt+1時，代表的是在pt的地址上加上16bytes。如果第2個<code>[]</code> 為空，編譯器則無法處理</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">sum2d</span><span class="params">(<span class="keyword">int</span> ar[<span class="number">3</span>][<span class="number">4</span>], <span class="keyword">int</span> rows)</span></span>; <span class="comment">//3會被忽略</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">int</span> arr4[<span class="number">4</span>];</span><br><span class="line"><span class="keyword">typedef</span> arr4 arr3x4[<span class="number">3</span>];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">sum2d</span><span class="params">(arr3x4 ar, <span class="keyword">int</span> rows)</span></span>; <span class="comment">//與以下相同</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">sum2d</span><span class="params">(<span class="keyword">int</span> ar[<span class="number">3</span>][<span class="number">4</span>], <span class="keyword">int</span> rows)</span></span>;<span class="comment">//與以下相同</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">sum2d</span><span class="params">(<span class="keyword">int</span> ar[][<span class="number">4</span>], <span class="keyword">int</span> rows)</span></span>;<span class="comment">//標準</span></span><br></pre></td></tr></table></figure>

<p>聲明一個n維的數組指針時，只能忽略最左邊的<code>[]</code></p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">sum4d</span><span class="params">(<span class="keyword">int</span> ar[][<span class="number">12</span>][<span class="number">20</span>][<span class="number">30</span>], <span class="keyword">int</span> rows)</span></span>;<span class="comment">//第1個[]用於表明ar是ptr</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">sum4d</span><span class="params">(<span class="keyword">int</span> (*ar)[<span class="number">12</span>][<span class="number">20</span>][<span class="number">30</span>], <span class="keyword">int</span> rows)</span></span>;<span class="comment">//與以上相同</span></span><br></pre></td></tr></table></figure>

<h2 id="變長數組-variable-length-array"><a href="#變長數組-variable-length-array" class="headerlink" title="變長數組 variable-length array"></a>變長數組 variable-length array</h2><p>var-leng array不是代表數組可以任意改變數組大小，一旦創建，它仍和普通數組一樣保持不變</p>
<p>聲明</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">sum2d</span><span class="params">(<span class="keyword">int</span> rows, <span class="keyword">int</span> cols, <span class="keyword">int</span> ar[rows][cols])</span></span>; <span class="comment">//ar 是一個變長數組</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">sum2d</span><span class="params">(<span class="keyword">int</span> ar[rows][cols], <span class="keyword">int</span> rows, <span class="keyword">int</span> cols)</span></span>; <span class="comment">//無效順序</span></span><br></pre></td></tr></table></figure>

<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">sum2d</span><span class="params">(<span class="keyword">int</span>, <span class="keyword">int</span>, <span class="keyword">int</span> ar[*][*])</span></span>; <span class="comment">//省略維度名</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">sum2d</span><span class="params">(<span class="keyword">int</span> rows, <span class="keyword">int</span> cols, <span class="keyword">int</span> ar[rows][cols])</span></span>&#123; <span class="comment">//定義</span></span><br><span class="line">  ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>注意！在fuuc中定義的變長數組並非實際創建數組，和傳統用語法一樣，皆為指針，可以讓我們修改其值</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">	<span class="keyword">int</span> thing[<span class="number">10</span>][<span class="number">6</span>];</span><br><span class="line">	twoset(<span class="number">10</span>, <span class="number">6</span>, thing);</span><br><span class="line">...</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">twoset</span><span class="params">(<span class="keyword">int</span> rows, <span class="keyword">int</span> cols, <span class="keyword">int</span> ar[rows][cols])</span></span>&#123;</span><br><span class="line">  ar[<span class="number">2</span>][<span class="number">5</span>] = <span class="number">10</span>; <span class="comment">//設ar[2][5]為2</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>此外，var-leng array能動態內存分配，這代表可以在prog運行時指定數組大小</p>
<h2 id="複合字面量-compound-literal"><a href="#複合字面量-compound-literal" class="headerlink" title="複合字面量 compound literal"></a>複合字面量 compound literal</h2><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">double</span> t[<span class="number">2</span>] = &#123;<span class="number">8.9</span>, <span class="number">64.1</span>&#125;; <span class="comment">//normal array</span></span><br><span class="line">(<span class="keyword">int</span> [<span class="number">2</span>])&#123;<span class="number">10</span>, <span class="number">20</span>&#125;; <span class="comment">//compound literal</span></span><br></pre></td></tr></table></figure>

<p>因為compund literal是匿名的，必須再創建當刻時使用</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> * pt1;</span><br><span class="line">pt1 = (<span class="keyword">int</span> [<span class="number">2</span>])&#123;<span class="number">10</span>,<span class="number">20</span>&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">//*pt1 = 10</span></span><br><span class="line"><span class="comment">//pt1[1] = 20</span></span><br></pre></td></tr></table></figure>

<p>除了利用ptr，亦可以傳遞給func</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">sum</span><span class="params">(<span class="keyword">const</span> <span class="keyword">int</span> ar[], <span class="keyword">int</span> n)</span></span>;</span><br><span class="line">...</span><br><span class="line"><span class="keyword">int</span> total3;</span><br><span class="line">total3 = sum((<span class="keyword">int</span> [])&#123;<span class="number">19</span>,<span class="number">8</span>,<span class="number">3</span>,<span class="number">1</span>&#125;,<span class="number">4</span>);</span><br></pre></td></tr></table></figure>

<h2 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h2><ol>
<li>C primer plus</li>
</ol>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2020/07/25/c-basic-ch10/" data-id="ckdeeeaxx0003h5ro75qof8vj" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/C/" rel="tag">C</a></li></ul>

    </footer>
  </div>
  
    
<nav id="article-nav">
  
  
    <a href="/2020/07/25/c-basic-ch9/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Older</strong>
      <div class="article-nav-title">C Basic ch9(函數／指針簡介)</div>
    </a>
  
</nav>

  
</article>

</section>
        
          <aside id="sidebar">
  
    

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tags</h3>
    <div class="widget">
      <ul class="tag-list" itemprop="keywords"><li class="tag-list-item"><a class="tag-list-link" href="/tags/C/" rel="tag">C</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Flask/" rel="tag">Flask</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Python/" rel="tag">Python</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/SQL/" rel="tag">SQL</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tag Cloud</h3>
    <div class="widget tagcloud">
      <a href="/tags/C/" style="font-size: 20px;">C</a> <a href="/tags/Flask/" style="font-size: 10px;">Flask</a> <a href="/tags/Python/" style="font-size: 10px;">Python</a> <a href="/tags/SQL/" style="font-size: 10px;">SQL</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/07/">July 2020</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2020/07/25/c-basic-ch10/">C Basic ch10(數組和指針)</a>
          </li>
        
          <li>
            <a href="/2020/07/25/c-basic-ch9/">C Basic ch9(函數／指針簡介)</a>
          </li>
        
          <li>
            <a href="/2020/07/15/c-basic-ch7/">C Basic ch7(控制語句)</a>
          </li>
        
          <li>
            <a href="/2020/07/14/c-basic-ch4/">C basic ch4(字符串和格式化輸入／出)</a>
          </li>
        
          <li>
            <a href="/2020/07/13/c-basic-ch6/">C basic ch6(循環及數組)</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2020 John Doe<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
    <a href="/about" class="mobile-nav-link">About</a>
  
</nav>
    

<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  
<link rel="stylesheet" href="/fancybox/jquery.fancybox.css">

  
<script src="/fancybox/jquery.fancybox.pack.js"></script>




<script src="/js/script.js"></script>




  </div>
</body>
</html>